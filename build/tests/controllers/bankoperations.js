// Generated by CoffeeScript 1.6.2
var client, fixtures, helpers, path, should;

should = require('should');

path = require('path');

fixtures = require('cozy-fixtures');

fixtures.setDefaultValues({
  dirPath: path.resolve(__dirname, '../fixtures/'),
  silent: true,
  removeBeforeLoad: false
});

helpers = require('../helpers');

client = helpers.getClient();

describe("Bank Operations Controller", function() {
  before(helpers.cleanDBWithRequests);
  before(helpers.startApp);
  after(helpers.stopApp);
  after(helpers.cleanDBWithRequests);
  return describe("When I add bank operations", function() {
    before(helpers.cleanDB);
    before(function(done) {
      return fixtures.load({
        doctypeTarget: 'BankAccount',
        callback: done
      });
    });
    after(helpers.cleanDB);
    describe.skip("When I GET /operations", function() {
      var _this = this;

      this.err = null;
      this.res = null;
      this.body = null;
      before(function(done) {
        return client.get('bankoperations', function(err, res, body) {
          _this.err = err;
          _this.res = res;
          _this.body = body;
          return done();
        });
      });
      return it("The response should be a success", function() {
        should.not.exist(_this.err);
        should.exist(_this.res);
        should.exist(_this.body);
        _this.res.should.have.property('statusCode');
        _this.res.statusCode.should.equal(200);
        return _this.body.should.be.an.Array;
      });
    });
    describe.skip("When I GET /bankoperation/:bankAccountID with an existing ID", function() {
      var _this = this;

      this.err = null;
      this.res = null;
      this.body = null;
      this.expectedBody = null;
      before(function(done) {
        return client.get('banks', function(err, res, body) {
          _this.expectedBody = body[0];
          return client.get("banks/" + _this.expectedBody.id, function(err, res, body) {
            _this.err = err;
            _this.res = res;
            _this.body = body;
            return done();
          });
        });
      });
      return it("The response should be a success", function() {
        should.not.exist(_this.err);
        should.exist(_this.res);
        should.exist(_this.body);
        _this.res.should.have.property('statusCode');
        _this.res.statusCode.should.equal(200);
        return _this.body.should.be.an.Object;
      });
    });
    describe("When I GET /bankoperations/:bankOperationID with an unknown ID", function() {
      var _this = this;

      this.err = null;
      this.res = null;
      this.body = null;
      before(function(done) {
        return client.get("bankoperations/123", function(err, res, body) {
          _this.err = err;
          _this.res = res;
          _this.body = body;
          return done();
        });
      });
      return it("The response should be an error", function() {
        should.not.exist(_this.err);
        should.exist(_this.res);
        should.exist(_this.body);
        _this.res.should.have.property('statusCode');
        _this.res.statusCode.should.equal(404);
        return _this.body.should.have.property('error');
      });
    });
    describe("When I POST /bankoperations", function() {
      it("The response should be a success");
      return it("And the bank operation should be in the database");
    });
    return describe("When I GET /bankoperations/query", function() {
      it("The response should be a success");
      return it("It should return a result matching the query");
    });
  });
});
